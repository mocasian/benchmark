<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Sequence Memory</title>
<style>
  body {
    background: #111;
    color: white;
    font-family: sans-serif;
    text-align: center;
    padding: 50px;
    transition: background 0.3s, color 0.3s;
  }
  .light {
    background: #f4f4f4;
    color: #111;
  }
  #backButton {
    position: absolute;
    top: 20px; left: 20px;
    padding: 10px 15px;
    background: #444;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  #backButton:hover {
    background: #666;
  }
  #buttons {
    margin-top: 30px;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
  }
  button {
    font-size: 1.3em;
    padding: 15px 25px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #444;
    color: white;
    user-select: none;
  }
  button:active {
    background: #666;
  }
  button.disabled {
    background: #222;
    cursor: default;
  }
  #message {
    margin-top: 20px;
    font-size: 1.2em;
  }
</style>
</head>
<body>
<button id="backButton" onclick="window.location.href='index.html'">‚Üê Back</button>
<h1>Sequence Memory</h1>

<div id="buttons"></div>
<div id="message"></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "benchmark-f06e7.firebaseapp.com",
    databaseURL: "https://benchmark-f06e7-default-rtdb.firebaseio.com/",
    projectId: "benchmark-f06e7",
    storageBucket: "benchmark-f06e7.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const buttonsDiv = document.getElementById("buttons");
  const message = document.getElementById("message");

  const options = ["A", "S", "D", "F", "J", "K", "L", ";"];
  let sequence = [];
  let userIndex = 0;
  let level = 1;
  let inputEnabled = false;

  function createButtons() {
    buttonsDiv.innerHTML = "";
    options.forEach(opt => {
      const btn = document.createElement("button");
      btn.textContent = opt;
      btn.id = "btn-" + opt;
      btn.addEventListener("click", () => handleUserInput(opt));
      buttonsDiv.appendChild(btn);
    });
  }

  function flashButton(opt) {
    const btn = document.getElementById("btn-" + opt);
    if (!btn) return;
    btn.classList.add("disabled");
    setTimeout(() => btn.classList.remove("disabled"), 500);
  }

  function playSequence() {
    inputEnabled = false;
    let i = 0;
    message.textContent = "Watch the sequence...";
    const interval = setInterval(() => {
      if(i >= sequence.length) {
        clearInterval(interval);
        inputEnabled = true;
        message.textContent = "Repeat the sequence by clicking buttons.";
        userIndex = 0;
        return;
      }
      flashButton(sequence[i]);
      i++;
    }, 800);
  }

  function nextLevel() {
    sequence.push(options[Math.floor(Math.random() * options.length)]);
    playSequence();
    level = sequence.length;
  }

  function handleUserInput(opt) {
    if(!inputEnabled) return;

    if(opt === sequence[userIndex]) {
      userIndex++;
      if(userIndex === sequence.length) {
        message.textContent = "Correct! Next round...";
        inputEnabled = false;
        setTimeout(nextLevel, 1000);
      }
    } else {
      gameOver();
    }
  }

  function gameOver() {
    message.textContent = `Game Over! You reached level ${level}.`;
    saveScore(level);
    sequence = [];
    level = 0;
    inputEnabled = false;
    setTimeout(() => {
      message.textContent = "Starting new game...";
      nextLevel();
    }, 3000);
  }

  function saveScore(score) {
    const best = parseInt(localStorage.getItem("sequenceMemory")) || 0;
    if(score > best) {
      localStorage.setItem("sequenceMemory", score);
    }
    const name = prompt("Enter your name for leaderboard:");
    if(name) {
      db.ref("sequenceMemoryScores").push({
        name,
        level: score
      });
    }
  }

  window.onload = () => {
    createButtons();
    nextLevel();

    if(localStorage.getItem("theme") === "light") {
      document.body.classList.add("light");
    }
  };
</script>
</body>
</html>
